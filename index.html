<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>ðŸŒŸ A1 Interactive Word Search ðŸŒŸ</title>
  <style>
    body {
      font-family: 'Comic Sans MS', cursive;
      background-color: #f0fff4;  /* soft mint */
      text-align: center;
      padding: 20px;
      position: relative;
      min-height: 100vh;
      box-sizing: border-box;
    }
    h1 { color: #2e8b57; }  /* sea green */
    #grid { margin: 20px auto; border-collapse: collapse; }
    #grid td {
      width: 40px;
      height: 40px;
      text-align: center;
      font-size: 24px;
      border: 2px solid #98fb98;  /* pale green */
      cursor: pointer;
      transition: background 0.2s;
      user-select: none;
    }
    #grid td.selected { background-color: #c2f0c2; }   /* light mint */
    #grid td.found    { background-color: #7fffd4; }   /* aquamarine */
    .instructions { font-size: 16px; color: #444; margin-bottom: 10px; }
    .word-list    { margin-top: 20px; font-size: 18px; color: #333; }
    .found-word   { text-decoration: line-through; color: #2e8b57; }
    #victory      { font-size: 24px; color: #2e8b57; margin-top: 20px; display: none; }
    input#words   { text-transform: uppercase; }
    footer { position: absolute; bottom: 0; width: 100%; padding: 10px 0; background: rgba(0,128,0,0.05); }
  </style>
</head>
<body>
  <h1>ðŸŒŸ A1 Interactive Word Search ðŸŒŸ</h1>
  <p class="instructions">
    Enter <b>4 words (max 8 letters each)</b>.<br>
    Words can appear up, down, left, right, or diagonally.<br>
    Click and drag to find words!
  </p>

  <input type="text" id="words" placeholder="e.g. CAT, SUN, HOUSE, BOOK" style="width:350px; font-size:18px;">
  <button onclick="generate()">Generate Word Search</button>

  <table id="grid"></table>
  <div class="word-list" id="wordlist"></div>
  <div id="victory">ðŸŽ‰ Well Done! You found all the words! ðŸŽ‰</div>

  <script>
    document.getElementById('words').addEventListener('input', e => {
      e.target.value = e.target.value.toUpperCase();
    });

    let gridData = [], selectedCells = [], isMouseDown = false, words = [];
    const size = 8;
    const directions = [[1,0],[-1,0],[0,1],[0,-1],[1,1],[-1,-1],[1,-1],[-1,1]];
    let selectionDirection = null;

    function generate() {
      document.getElementById('victory').style.display = 'none';
      const input = document.getElementById('words').value;
      words = input.split(',').map(w => w.trim()).filter(Boolean);
      if (words.length !== 4) {
        alert('Please enter exactly 4 words separated by commas.');
        return;
      }
      for (let w of words) {
        if (w.length > 8) {
          alert(`"${w}" is too long! Max 8 letters.`);
          return;
        }
      }

      // initialize grid
      gridData = Array.from({ length: size }, () => Array(size).fill(''));

      // place words longest first
      words.sort((a, b) => b.length - a.length);

      for (let w of words) {
        let placed = false;
        for (let t = 0; t < 200 && !placed; t++) {
          const [dx, dy] = directions[Math.floor(Math.random() * directions.length)];
          const r = Math.floor(Math.random() * size);
          const c = Math.floor(Math.random() * size);
          if (canPlaceWord(w, r, c, dx, dy)) {
            placeWord(w, r, c, dx, dy);
            placed = true;
          }
        }
        if (!placed) {
          alert(`Could not place word "${w}". Please try again.`);
          return;
        }
      }

      // fill empty spaces
      const letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      for (let r = 0; r < size; r++) {
        for (let c = 0; c < size; c++) {
          if (!gridData[r][c]) {
            gridData[r][c] = letters[Math.floor(Math.random() * letters.length)];
          }
        }
      }

      renderGrid();
      document.getElementById('wordlist').innerHTML =
        'Find: ' + words.map(w => `<span id="word-${w}">${w}</span>`).join(', ');
    }

    function canPlaceWord(w, r, c, dx, dy) {
      for (let i = 0; i < w.length; i++) {
        if (r < 0 || r >= size || c < 0 || c >= size) return false;
        if (gridData[r][c] && gridData[r][c] !== w[i]) return false;
        r += dx;
        c += dy;
      }
      return true;
    }

    function placeWord(w, r, c, dx, dy) {
      for (let i = 0; i < w.length; i++) {
        gridData[r][c] = w[i];
        r += dx;
        c += dy;
      }
    }

    function renderGrid() {
      const table = document.getElementById('grid');
      table.innerHTML = '';
      for (let r = 0; r < size; r++) {
        const tr = document.createElement('tr');
        for (let c = 0; c < size; c++) {
          const td = document.createElement('td');
          td.textContent = gridData[r][c];
          td.dataset.row = r;
          td.dataset.col = c;
          td.addEventListener('mousedown', startSelection);
          td.addEventListener('mouseover', dragSelection);
          td.addEventListener('mouseup', endSelection);
          tr.appendChild(td);
        }
        table.appendChild(tr);
      }
      document.body.addEventListener('mouseup', () => isMouseDown = false);
    }

    function startSelection(e) {
      clearSelection();
      isMouseDown = true;
      selectionDirection = null;
      selectCell(e.target);
    }

    function dragSelection(e) {
      if (isMouseDown) selectCell(e.target);
    }

    function endSelection() {
      isMouseDown = false;
      checkSelection();
    }

    function selectCell(cell) {
      if (!cell.dataset.row || cell.classList.contains('selected')) return;
      const r = +cell.dataset.row;
      const c = +cell.dataset.col;
      if (selectedCells.length === 0) {
        cell.classList.add('selected');
        selectedCells.push(cell);
        return;
      }
      const first = selectedCells[0];
      const fr = +first.dataset.row;
      const fc = +first.dataset.col;
      const last = selectedCells[selectedCells.length - 1];
      const lr = +last.dataset.row;
      const lc = +last.dataset.col;
      if (!selectionDirection) {
        const dr = r - fr;
        const dc = c - fc;
        if (Math.abs(dr) <= 1 && Math.abs(dc) <= 1 && (dr !== 0 || dc !== 0)) {
          selectionDirection = [Math.sign(dr), Math.sign(dc)];
        } else return;
      }
      const [dx, dy] = selectionDirection;
      if (r === lr + dx && c === lc + dy) {
        cell.classList.add('selected');
        selectedCells.push(cell);
      }
    }

    function clearSelection() {
      selectedCells.forEach(c => c.classList.remove('selected'));
      selectedCells = [];
      selectionDirection = null;
    }

    function checkSelection() {
      if (!selectedCells.length) return;
      const str = selectedCells.map(c => c.textContent).join('');
      const rev = str.split('').reverse().join('');
      let found = null;
      if (words.includes(str)) found = str;
      else if (words.includes(rev)) found = rev;
      if (found) {
        selectedCells.forEach(c => {
          c.classList.remove('selected');
          c.classList.add('found');
        });
        document.getElementById('word-' + found).classList.add('found-word');
        checkVictory();
      } else {
        clearSelection();
      }
    }

    function checkVictory() {
      if (words.every(w => document.getElementById('word-' + w).classList.contains('found-word'))) {
        document.getElementById('victory').style.display = 'block';
      }
    }
  </script>

  <hr>
  <footer>
    &copy; All rights reserved Young Learners Curriculum
  </footer>
</body>
</html>
